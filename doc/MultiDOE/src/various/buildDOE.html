<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of buildDOE</title>
  <meta name="keywords" content="buildDOE">
  <meta name="description" content="Copyright or © or Copr. Luc LAURENT (30/06/2016)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html MultiDOE --><!-- # src --><!-- menu.html various -->
<h1>buildDOE
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Copyright or © or Copr. Luc LAURENT (30/06/2016)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [out,infoSampling]=buildDOE(doe) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Copyright or © or Copr. Luc LAURENT (30/06/2016)
 luc.laurent@lecnam.net
 
 This software is a computer program whose purpose is to generate sampling
 using dedicated techniques.
 
 This software is governed by the CeCILL license under French law and
 abiding by the rules of distribution of free software.  You can  use, 
 modify and/ or redistribute the software under the terms of the CeCILL
 license as circulated by CEA, CNRS and INRIA at the following URL
 &quot;http://www.cecill.info&quot;. 
 
 As a counterpart to the access to the source code and  rights to copy,
 modify and redistribute granted by the license, users are provided only
 with a limited warranty  and the software's author,  the holder of the
 economic rights,  and the successive licensors  have only  limited
 liability. 
 
 In this respect, the user's attention is drawn to the risks associated
 with loading,  using,  modifying and/or developing or reproducing the
 software by the user in light of its specific status of free software,
 that may mean  that it is complicated to manipulate,  and  that  also
 therefore means  that it is reserved for developers  and  experienced
 professionals having in-depth computer knowledge. Users are therefore
 encouraged to load and test the software's suitability as regards their
 requirements in conditions enabling the security of their systems and/or 
 data to be ensured and,  more generally, to use and operate it in the 
 same conditions as regards security. 
 
 The fact that you are presently reading this means that you have had
 knowledge of the CeCILL license and that you accept its terms.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../MultiDOE/src/DOE/fullFactDOE.html" class="code" title="function sampling=fullFactDOE(ns,Xmin,Xmax)">fullFactDOE</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/DOE/glhsR.html" class="code" title="function [sampling,newSampling]=glhsR(Xmin,Xmax,ns,oldSampling,nbInfill)">glhsR</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/DOE/ihsR.html" class="code" title="function [sampling,newSampling]=ihsR(Xmin,Xmax,ns,oldSampling)">ihsR</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/DOE/lhsuR.html" class="code" title="function [sampling,newSampling]=lhsuR(Xmin,Xmax,ns,oldSampling)">lhsuR</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/DOE/mmlhsR.html" class="code" title="function [sampling,newSampling]=mmlhsR(Xmin,Xmax,ns,oldsampling,nbInfill)">mmlhsR</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/DOE/olhsR.html" class="code" title="function [sampling,newSampling]=olhsR(Xmin,Xmax,ns,oldSampling,nbInfill)">olhsR</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/crit/calcScore.html" class="code" title="function [uniform,discrepancy]=calcScore(sampling,q)">calcScore</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/disp/displayDOE.html" class="code" title="function displayDOE(sampling,doe,missData)">displayDOE</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/src/libs/IHS/ihs.html" class="code" title="function x = ihs ( dim_num, point_num, duplication )">ihs</a>	*****************************************************************************80</li><li><a href="../../../MultiDOE/src/libs/LHS/lhsu.html" class="code" title="function s=lhsu(xmin,xmax,nsample)">lhsu</a>	s=lhsu(xmin,xmax,nsample)</li><li><a href="mesuTime.html" class="code" title="function [tictoc_compt,tInit]=mesuTime(compteur,tps_init)">mesuTime</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li><li><a href="sortDOE.html" class="code" title="function samplingSorted = sortDOE(sampling,doe)">sortDOE</a>	Copyright or © or Copr. Luc LAURENT (30/06/2016)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../MultiDOE/ExampleInfill.html" class="code" title="">ExampleInfill</a>	Copyright or Â© or Copr. Luc LAURENT (30/06/2016)</li><li><a href="../../../MultiDOE/ExampleUse.html" class="code" title="">ExampleUse</a>	% Example of use of the MultiDOE toolbox</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [sampling,fich]=checkDOE(nameFile,np,ns)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% Copyright or © or Copr. Luc LAURENT (30/06/2016)</span>
0002 <span class="comment">% luc.laurent@lecnam.net</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% This software is a computer program whose purpose is to generate sampling</span>
0005 <span class="comment">% using dedicated techniques.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% This software is governed by the CeCILL license under French law and</span>
0008 <span class="comment">% abiding by the rules of distribution of free software.  You can  use,</span>
0009 <span class="comment">% modify and/ or redistribute the software under the terms of the CeCILL</span>
0010 <span class="comment">% license as circulated by CEA, CNRS and INRIA at the following URL</span>
0011 <span class="comment">% &quot;http://www.cecill.info&quot;.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% As a counterpart to the access to the source code and  rights to copy,</span>
0014 <span class="comment">% modify and redistribute granted by the license, users are provided only</span>
0015 <span class="comment">% with a limited warranty  and the software's author,  the holder of the</span>
0016 <span class="comment">% economic rights,  and the successive licensors  have only  limited</span>
0017 <span class="comment">% liability.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% In this respect, the user's attention is drawn to the risks associated</span>
0020 <span class="comment">% with loading,  using,  modifying and/or developing or reproducing the</span>
0021 <span class="comment">% software by the user in light of its specific status of free software,</span>
0022 <span class="comment">% that may mean  that it is complicated to manipulate,  and  that  also</span>
0023 <span class="comment">% therefore means  that it is reserved for developers  and  experienced</span>
0024 <span class="comment">% professionals having in-depth computer knowledge. Users are therefore</span>
0025 <span class="comment">% encouraged to load and test the software's suitability as regards their</span>
0026 <span class="comment">% requirements in conditions enabling the security of their systems and/or</span>
0027 <span class="comment">% data to be ensured and,  more generally, to use and operate it in the</span>
0028 <span class="comment">% same conditions as regards security.</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% The fact that you are presently reading this means that you have had</span>
0031 <span class="comment">% knowledge of the CeCILL license and that you accept its terms.</span>
0032 
0033 <span class="comment">%% Building sampling</span>
0034 <span class="comment">%% L. LAURENT -- 17/12/2010 -- luc.laurent@lecnam.net</span>
0035 
0036 <span class="comment">%Some criteria require the Matlab's toolbox &quot;Random Numbers Generators&quot; or</span>
0037 <span class="comment">%the R software</span>
0038 
0039 <span class="comment">%All sampling techniques provide sample points with values between 0 and 1.</span>
0040 <span class="comment">%The convertion to the right sapce is done at the end of this file.</span>
0041 
0042 <span class="comment">%% Syntax: gene_doe(doe)</span>
0043 <span class="comment">%% INPUT variables:</span>
0044 <span class="comment">% -doe: structure obtaind with initDOE and complete manually</span>
0045 
0046 <span class="comment">%   + Kind of DOE (doe.type): see the switch command below</span>
0047 <span class="comment">%   + All methods containing the string '_R' require the R software</span>
0048 <span class="comment">%   (installed on the computer and accessible using the command line).</span>
0049 <span class="comment">%   Libraries 'lhs' and 'R.matlab' must be installed on R</span>
0050 <span class="comment">%   + All methods containing the string '_MANU' are saved sampling (they</span>
0051 <span class="comment">%   are built one time are are reloaded from a .mat file)</span>
0052 <span class="comment">%   + Many sorting methods are available using doe.sort (see sortDOE.m)</span>
0053 
0054 <span class="comment">%% OUTPUT variables</span>
0055 <span class="comment">% - out: contains the sampling (sorted and unsorted)</span>
0056 <span class="comment">% -infoSampling(optional): many information about the sampling</span>
0057 
0058 
0059 <a name="_sub0" href="#_subfunctions" class="code">function [out,infoSampling]=buildDOE(doe)</a>
0060 
0061 
0062 fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0063 fprintf(<span class="string">'    &gt;&gt;&gt; BUILDING SAMPLING &lt;&lt;&lt;\n'</span>);
0064 [tMesu,tInit]=<a href="mesuTime.html" class="code" title="function [tictoc_compt,tInit]=mesuTime(compteur,tps_init)">mesuTime</a>;
0065 
0066 <span class="comment">% For obtaining an &quot;actual&quot; pseudo-random sampling</span>
0067 s = RandStream(<span class="string">'mt19937ar'</span>,<span class="string">'Seed'</span>,<span class="string">'shuffle'</span>);
0068 RandStream.setGlobalStream(s);
0069 
0070 <span class="comment">%recovering the required number of sample points</span>
0071 nsUndef=true;
0072 <span class="keyword">if</span> isfield(doe,<span class="string">'ns'</span>)
0073     <span class="keyword">if</span> ~isempty(doe.ns)
0074         ns=doe.ns;
0075         nsUndef=false;
0076     <span class="keyword">end</span>
0077 <span class="keyword">end</span>
0078 <span class="keyword">if</span> nsUndef;
0079     error([<span class="string">'Undefined number of sample points ''doe.ns'' ('</span>,mfilename,<span class="string">')'</span>]);
0080 <span class="keyword">end</span>
0081 
0082 <span class="comment">%recovering number of iteration if specified</span>
0083 <span class="keyword">if</span> isfield(doe,<span class="string">'iter'</span>);nbIter=doe.iter;<span class="keyword">else</span> nbIter=5;<span class="keyword">end</span>
0084 
0085 <span class="comment">%number of generation for computing the scores</span>
0086 nbGene=20;
0087 
0088 <span class="comment">%recovering bounds of the design sapce</span>
0089 boundsUndef=true;
0090 <span class="keyword">if</span> isfield(doe,<span class="string">'Xmin'</span>)&amp;&amp;isfield(doe,<span class="string">'Xmax'</span>)
0091     <span class="keyword">if</span> ~isempty(doe.Xmin)&amp;&amp;~isempty(doe.Xmax)
0092         Xmin=doe.Xmin;
0093         Xmax=doe.Xmax;
0094         boundsUndef=false;
0095     <span class="keyword">end</span>
0096 <span class="keyword">elseif</span> isfield(doe,<span class="string">'bornes'</span>)
0097     <span class="keyword">if</span> ~isempty(doe.bornes)
0098         Xmin=doe.bornes(:,1);
0099         Xmax=doe.bornes(:,2);
0100         doe.Xmin=Xmin;doe.Xmax=Xmax;
0101         boundsUndef=false;
0102     <span class="keyword">end</span>
0103 <span class="keyword">end</span>
0104 <span class="keyword">if</span> boundsUndef
0105     error([<span class="string">'Undefined bounds of the design space ''doe.Xmin'' an ''doe.Xmax'' ('</span>,mfilename,<span class="string">')'</span>]);
0106 <span class="keyword">end</span>
0107 
0108 <span class="comment">%default values</span>
0109 XminDef=0.*Xmin;XmaxDef=0.*Xmax+1;
0110 
0111 <span class="comment">%number ofvariables</span>
0112 np=numel(Xmin);
0113 
0114 <span class="comment">%default sorting options</span>
0115 <span class="keyword">if</span> ~isfield(doe,<span class="string">'sort'</span>);doe.sort=[];<span class="keyword">end</span>
0116 <span class="keyword">if</span> ~isfield(doe.sort,<span class="string">'on'</span>);doe.sort.on=false;<span class="keyword">end</span>
0117 <span class="keyword">if</span> ~isfield(doe.sort,<span class="string">'lnorm'</span>);doe.sort.lnorm=2;<span class="keyword">end</span>
0118 
0119 <span class="comment">%% Show information</span>
0120 fprintf(<span class="string">' &gt;&gt; Kind of DOE de tirages: %s\n'</span>,doe.type);
0121 fprintf(<span class="string">' &gt;&gt; Number of sample points: '</span>)
0122 fprintf(<span class="string">'%i '</span>,ns);fprintf(<span class="string">'\n'</span>);
0123 fprintf(<span class="string">' &gt;&gt; Number of variables: %i\n'</span>,np);
0124 
0125 samplingOK=true;
0126 customSampling=false;
0127 <span class="comment">%depending on the chosen DOE technique</span>
0128 <span class="keyword">switch</span> doe.type
0129     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0130     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0131     <span class="comment">% full factorial</span>
0132     <span class="keyword">case</span> <span class="string">'ffact'</span>        
0133         sampling=<a href="../../../MultiDOE/src/DOE/fullFactDOE.html" class="code" title="function sampling=fullFactDOE(ns,Xmin,Xmax)">fullFactDOE</a>(ns,XminDef,XmaxDef);
0134         <span class="keyword">if</span> numel(ns)==1
0135             ns=ns^np;
0136         <span class="keyword">end</span>
0137         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0138         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0139         <span class="comment">% Latin Hypercube Sampling with R (and initial enrichment)</span>
0140     <span class="keyword">case</span> <span class="string">'LHS_R'</span>
0141         sampling=<a href="../../../MultiDOE/src/DOE/lhsuR.html" class="code" title="function [sampling,newSampling]=lhsuR(Xmin,Xmax,ns,oldSampling)">lhsuR</a>(XminDef,XmaxDef,prod(ns(:)));
0142         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0143         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0144     <span class="keyword">case</span> <span class="string">'LHS_R_manu'</span>
0145         <span class="comment">%recover sampling if available</span>
0146         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsuR'</span>,np,ns);
0147         <span class="keyword">if</span> isempty(sampling)
0148             sampling=<a href="../../../MultiDOE/src/DOE/lhsuR.html" class="code" title="function [sampling,newSampling]=lhsuR(Xmin,Xmax,ns,oldSampling)">lhsuR</a>(XminDef,XmaxDef,prod(ns(:))); 
0149             save(fich,<span class="string">'sampling'</span>);
0150         <span class="keyword">end</span>
0151         
0152         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0153         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0154         <span class="comment">% Optimal Latin Hypercube Sampling with R (and initial enrichment)</span>
0155     <span class="keyword">case</span> <span class="string">'OLHS_R'</span>
0156         sampling=<a href="../../../MultiDOE/src/DOE/olhsR.html" class="code" title="function [sampling,newSampling]=olhsR(Xmin,Xmax,ns,oldSampling,nbInfill)">olhsR</a>(XminDef,XmaxDef,prod(ns(:)));
0157         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0158         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0159     <span class="keyword">case</span> <span class="string">'OLHS_R_manu'</span>
0160         <span class="comment">%recover sampling if available</span>
0161         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'olhsR'</span>,np,ns);
0162         <span class="keyword">if</span> isempty(sampling)
0163             sampling=<a href="../../../MultiDOE/src/DOE/olhsR.html" class="code" title="function [sampling,newSampling]=olhsR(Xmin,Xmax,ns,oldSampling,nbInfill)">olhsR</a>(XminDef,XmaxDef,prod(ns(:)));
0164             save(fich,<span class="string">'sampling'</span>);
0165         <span class="keyword">end</span>
0166         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0167         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0168         <span class="comment">% Maximin Latin Hypercube Sampling with R (and initial enrichment)</span>
0169     <span class="keyword">case</span> <span class="string">'MMLHS_R'</span>
0170         sampling=<a href="../../../MultiDOE/src/DOE/mmlhsR.html" class="code" title="function [sampling,newSampling]=mmlhsR(Xmin,Xmax,ns,oldsampling,nbInfill)">mmlhsR</a>(XminDef,XmaxDef,prod(ns(:)));
0171         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0172         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0173     <span class="keyword">case</span> <span class="string">'MMLHS_R_manu'</span>
0174          <span class="comment">%recover sampling if available</span>
0175         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'mmlhsR'</span>,np,ns);
0176         <span class="keyword">if</span> isempty(sampling)
0177             sampling=<a href="../../../MultiDOE/src/DOE/mmlhsR.html" class="code" title="function [sampling,newSampling]=mmlhsR(Xmin,Xmax,ns,oldsampling,nbInfill)">mmlhsR</a>(XminDef,XmaxDef,prod(ns(:))); 
0178             save(fich,<span class="string">'sampling'</span>);
0179         <span class="keyword">end</span>
0180         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0181         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0182         <span class="comment">% Genetic  Latin Hypercube Sampling with R (and initial enrichment)</span>
0183     <span class="keyword">case</span> <span class="string">'GLHS_R'</span>
0184         sampling=<a href="../../../MultiDOE/src/DOE/glhsR.html" class="code" title="function [sampling,newSampling]=glhsR(Xmin,Xmax,ns,oldSampling,nbInfill)">glhsR</a>(XminDef,XmaxDef,prod(ns(:)));
0185         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0186         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0187     <span class="keyword">case</span> <span class="string">'GLHS_R_manu'</span>
0188          <span class="comment">%recover sampling if available</span>
0189         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'glhsR'</span>,np,ns);
0190         <span class="keyword">if</span> isempty(sampling)
0191             sampling=glhsuR(XminDef,XmaxDef,prod(ns(:))); 
0192             save(fich,<span class="string">'sampling'</span>);
0193         <span class="keyword">end</span>
0194         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0195         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0196         <span class="comment">% Improved Hypercube Sampling avec R (et preenrichissement)</span>
0197     <span class="keyword">case</span> <span class="string">'IHS_R'</span>
0198         sampling=<a href="../../../MultiDOE/src/DOE/ihsR.html" class="code" title="function [sampling,newSampling]=ihsR(Xmin,Xmax,ns,oldSampling)">ihsR</a>(XminDef,XmaxDef,prod(ns(:)));
0199         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0200         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0201     <span class="keyword">case</span> <span class="string">'IHS_R_manu'</span>
0202          <span class="comment">%recover sampling if available</span>
0203         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'ihsR'</span>,np,ns);
0204         <span class="keyword">if</span> isempty(sampling)
0205             sampling=<a href="../../../MultiDOE/src/DOE/ihsR.html" class="code" title="function [sampling,newSampling]=ihsR(Xmin,Xmax,ns,oldSampling)">ihsR</a>(XminDef,XmaxDef,prod(ns(:))); 
0206             save(fich,<span class="string">'sampling'</span>);
0207         <span class="keyword">end</span>
0208         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0209         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0210         <span class="comment">% Sampling using Halton sequence (Matlab's function)</span>
0211     <span class="keyword">case</span> <span class="string">'HALTON'</span>
0212         p = haltonset(np,<span class="string">'Skip'</span>,1e3,<span class="string">'Leap'</span>,1e2);
0213         p = scramble(p,<span class="string">'RR2'</span>);
0214         sampling=net(p,prod(ns(:)));
0215         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0216         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0217         <span class="comment">% Halton with storage of the data</span>
0218     <span class="keyword">case</span> <span class="string">'HALTON_manu'</span>
0219          <span class="comment">%recover sampling if available</span>
0220         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'halton'</span>,np,ns);
0221         <span class="keyword">if</span> isempty(sampling)
0222             p = haltonset(np,<span class="string">'Skip'</span>,1e3,<span class="string">'Leap'</span>,1e2);
0223             p = scramble(p,<span class="string">'RR2'</span>);
0224             sampling=net(p,prod(ns(:)));
0225             save(fich,<span class="string">'sampling'</span>);
0226         <span class="keyword">end</span>
0227         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0228         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0229         <span class="comment">% Sampling using Sobol sequence (Matlab's function)</span>
0230     <span class="keyword">case</span> <span class="string">'SOBOL'</span>
0231         p = sobolset(np,<span class="string">'Skip'</span>,1e3,<span class="string">'Leap'</span>,1e2);
0232         p = scramble(p,<span class="string">'MatousekAffineOwen'</span>);
0233         sampling=net(p,prod(ns(:)));
0234         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0235         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0236         <span class="comment">% Sobol with storage of the data</span>
0237     <span class="keyword">case</span> <span class="string">'SOBOL_manu'</span>
0238          <span class="comment">%recover sampling if available</span>
0239         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'sobol'</span>,np,ns);
0240         <span class="keyword">if</span> isempty(sampling)
0241             p = sobolset(np,<span class="string">'Skip'</span>,1e3,<span class="string">'Leap'</span>,1e2);
0242             p = scramble(p,<span class="string">'MatousekAffineOwen'</span>);
0243             sampling=net(p,prod(ns(:)));
0244             save(fich,<span class="string">'sampling'</span>);
0245         <span class="keyword">end</span>
0246         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0247         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0248         <span class="comment">% Latin Hypercube Sampling (Matlab's function)</span>
0249     <span class="keyword">case</span> <span class="string">'LHSD'</span>
0250         sampling=lhsdesign(prod(ns(:)),np,<span class="string">'iterations'</span>,nbIter);
0251         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0252         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0253         <span class="comment">% LHS with storage of the data</span>
0254     <span class="keyword">case</span> <span class="string">'LHSD_manu'</span>
0255          <span class="comment">%recover sampling if available</span>
0256         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsd'</span>,np,ns);
0257         <span class="keyword">if</span> isempty(sampling)
0258             sampling=lhsdesign(prod(ns(:)),np,<span class="string">'iterations'</span>,nbIter);
0259             save(fich,<span class="string">'sampling'</span>);
0260         <span class="keyword">end</span>
0261         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0262         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0263         <span class="comment">% Latin Hypercube Sampling (Matlab's function) with minimization of the correlation (see help)</span>
0264     <span class="keyword">case</span> <span class="string">'LHSD_CORRMIN'</span>
0265         sampling=lhsdesign(prod(ns(:)),np,<span class="string">'criterion'</span>,<span class="string">'correlation'</span>,<span class="string">'iterations'</span>,nbIter);
0266         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0267         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0268        <span class="comment">% LHS with storage of the data</span>
0269     <span class="keyword">case</span> <span class="string">'LHSD_CORRMIN_manu'</span>
0270          <span class="comment">%recover sampling if available</span>
0271         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsdcorrmin'</span>,np,ns);
0272         <span class="keyword">if</span> isempty(sampling)
0273             sampling=lhsdesign(prod(ns(:)),np,<span class="string">'criterion'</span>,<span class="string">'correlation'</span>,<span class="string">'iterations'</span>,nbIter);
0274             save(fich,<span class="string">'sampling'</span>);
0275         <span class="keyword">end</span>
0276         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0277         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0278         <span class="comment">% Latin Hypercube Sampling (Matlab's function) with maximin (see help)</span>
0279     <span class="keyword">case</span> <span class="string">'LHSD_MAXMIN'</span>
0280         sampling=lhsdesign(prod(ns(:)),np,<span class="string">'criterion'</span>,<span class="string">'maximin'</span>,<span class="string">'iterations'</span>,nbIter);
0281         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0282         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0283         <span class="comment">% LHS with storage of the data</span>
0284     <span class="keyword">case</span> <span class="string">'LHSD_MAXMIN_manu'</span>
0285          <span class="comment">%recover sampling if available</span>
0286         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsdmaxmin'</span>,np,ns);
0287         <span class="keyword">if</span> isempty(sampling)
0288             sampling=lhsdesign(prod(ns(:)),np,<span class="string">'criterion'</span>,<span class="string">'maximin'</span>,<span class="string">'iterations'</span>,nbIter);
0289             save(fich,<span class="string">'sampling'</span>);
0290         <span class="keyword">end</span>
0291         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0292         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0293         <span class="comment">% Latin Hypercube Sampling (Matlab's function) with Non-smooth (see help)</span>
0294     <span class="keyword">case</span> <span class="string">'LHSD_NS'</span>
0295         sampling=lhsdesign(prod(ns(:)),np,<span class="string">'smooth'</span>,<span class="string">'off'</span>,<span class="string">'iterations'</span>,nbIter);
0296         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0297         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0298         <span class="comment">% LHS with storage of the data</span>
0299     <span class="keyword">case</span> <span class="string">'LHSD_NS_manu'</span>
0300          <span class="comment">%recover sampling if available</span>
0301         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsdns'</span>,np,ns);
0302         <span class="keyword">if</span> isempty(sampling)
0303             sampling=lhsdesign(prod(ns(:)),np,<span class="string">'smooth'</span>,<span class="string">'off'</span>,<span class="string">'iterations'</span>,nbIter);
0304             save(fich,<span class="string">'sampling'</span>);
0305         <span class="keyword">end</span>
0306         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0307         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0308         <span class="comment">% Latin Hypercube Sampling (with uniform law)</span>
0309     <span class="keyword">case</span> <span class="string">'LHS'</span>
0310         sampling=<a href="../../../MultiDOE/src/libs/LHS/lhsu.html" class="code" title="function s=lhsu(xmin,xmax,nsample)">lhsu</a>(XminDef,XmaxDef,prod(ns(:)));
0311         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0312         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0313         <span class="comment">% LHS with storage of the data</span>
0314     <span class="keyword">case</span> <span class="string">'LHS_manu'</span>
0315          <span class="comment">%recover sampling if available</span>
0316         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhsu'</span>,np,ns);
0317         <span class="keyword">if</span> isempty(sampling)
0318             sampling=<a href="../../../MultiDOE/src/libs/LHS/lhsu.html" class="code" title="function s=lhsu(xmin,xmax,nsample)">lhsu</a>(XminDef,XmaxDef,prod(ns(:)));
0319             save(fich,<span class="string">'sampling'</span>);
0320         <span class="keyword">end</span>
0321         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0322         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0323         <span class="comment">% Improved Hypercube Sampling</span>
0324     <span class="keyword">case</span> <span class="string">'IHS'</span>
0325         sampling=<a href="../../../MultiDOE/src/libs/IHS/ihs.html" class="code" title="function x = ihs ( dim_num, point_num, duplication )">ihs</a>(np,ns,5);
0326         sampling=sampling./ns;
0327         sampling=sampling';
0328         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0329         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0330     <span class="keyword">case</span> <span class="string">'IHS_manu'</span>
0331          <span class="comment">%recover sampling if available</span>
0332         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'ihs'</span>,np,ns);
0333         <span class="keyword">if</span> isempty(sampling)
0334             sampling=<a href="../../../MultiDOE/src/libs/IHS/ihs.html" class="code" title="function x = ihs ( dim_num, point_num, duplication )">ihs</a>(np,ns,5);
0335             sampling=sampling./ns;
0336             sampling=sampling';
0337             save(fich,<span class="string">'sampling'</span>);
0338         <span class="keyword">end</span>
0339         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0340         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0341         <span class="comment">% Latin Hypercube Sampling (with uniform law) with minimization of</span>
0342         <span class="comment">% distance of the inter-sample points</span>
0343     <span class="keyword">case</span> <span class="string">'LHS_O1'</span>
0344         samplingTMP=cell(1,nbGene);
0345         sc=zeros(1,nbGene);
0346         <span class="comment">%nbGene sampling are generated</span>
0347         <span class="keyword">for</span> ii=1:nbGene
0348             samplingTMP{ii}=<a href="../../../MultiDOE/src/libs/LHS/lhsu.html" class="code" title="function s=lhsu(xmin,xmax,nsample)">lhsu</a>(XminDef,XmaxDef,prod(ns(:)));
0349             <span class="comment">%compute score</span>
0350             uni=<a href="../../../MultiDOE/src/crit/calcScore.html" class="code" title="function [uniform,discrepancy]=calcScore(sampling,q)">calcScore</a>(samplingTMP{ii});
0351             sc(ii)=uni.sumDist;
0352         <span class="keyword">end</span>
0353         [~,IX]=min(sc);
0354         sampling=samplingTMP{IX};
0355         clear samplingTMP;
0356         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0357         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0358         <span class="comment">% LHS_O1 with storange of the data</span>
0359     <span class="keyword">case</span> <span class="string">'LHS_O1_manu'</span>
0360          <span class="comment">%recover sampling if available</span>
0361         [sampling,fich]=<a href="#_sub1" class="code" title="subfunction [sampling,fich]=checkDOE(nameFile,np,ns)">checkDOE</a>(<span class="string">'lhs_o1'</span>,np,ns);
0362         <span class="keyword">if</span> isempty(sampling)
0363             samplingTMP=cell(1,nbGene);
0364             sc=zeros(1,nbGene);
0365             <span class="comment">%nbGene sampling are generated</span>
0366             <span class="keyword">for</span> ii=1:nbGene
0367                 samplingTMP{ii}=<a href="../../../MultiDOE/src/libs/LHS/lhsu.html" class="code" title="function s=lhsu(xmin,xmax,nsample)">lhsu</a>(XminDef,XmaxDef,prod(ns(:)));
0368                 <span class="comment">%compute score</span>
0369                 uni=<a href="../../../MultiDOE/src/crit/calcScore.html" class="code" title="function [uniform,discrepancy]=calcScore(sampling,q)">calcScore</a>(samplingTMP{ii});
0370                 sc(ii)=uni.sumDist;
0371             <span class="keyword">end</span>
0372             [~,IX]=min(sc);
0373             sampling=samplingTMP{IX};
0374             clear samplingTMP
0375             save(fich,<span class="string">'sampling'</span>);
0376         <span class="keyword">end</span>
0377         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0378         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0379         <span class="comment">% randm sampling</span>
0380     <span class="keyword">case</span> <span class="string">'rand'</span>
0381         sampling=rand(prod(ns(:)),np);
0382         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0383         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0384         <span class="comment">%manually defined sampling</span>
0385     <span class="keyword">case</span> <span class="string">'custom'</span>
0386         sampling=doe.manu;
0387         customSampling=true;
0388         disp(<span class="string">'/!\ Manual sampling (cf. initDOE.m)'</span>);
0389     <span class="keyword">otherwise</span>
0390         error([<span class="string">'Undefined DOE methods ('</span>,mfilename,<span class="string">')'</span>]);
0391         samplingOK=false;
0392 <span class="keyword">end</span>
0393 
0394 <span class="keyword">if</span> samplingOK
0395     <span class="keyword">if</span> ~customSampling
0396         <span class="comment">% correction of the sampling for obtaining sampling defined on the</span>
0397         <span class="comment">% right design space</span>
0398         sampling=sampling.*repmat(Xmax(:)'-Xmin(:)',prod(ns(:)),1)+repmat(Xmin(:)',prod(ns(:)),1);
0399     <span class="keyword">end</span>
0400     
0401     <span class="comment">%if two output variables, other information will be stored</span>
0402     <span class="keyword">if</span> nargout==2
0403         <span class="keyword">if</span> doe.sort.on
0404             infoSampling.unsorted=sampling;
0405         <span class="keyword">end</span>
0406         <span class="comment">%compute scores of the sampling</span>
0407         [infoSampling.uniform,infoSampling.discrepance]=<a href="../../../MultiDOE/src/crit/calcScore.html" class="code" title="function [uniform,discrepancy]=calcScore(sampling,q)">calcScore</a>(sampling);
0408     <span class="keyword">end</span>
0409     <span class="comment">%sorting of the sampling</span>
0410     sortedSampling=<a href="sortDOE.html" class="code" title="function samplingSorted = sortDOE(sampling,doe)">sortDOE</a>(sampling,doe);
0411     
0412     <span class="comment">%shwo sampling</span>
0413     <a href="../../../MultiDOE/src/disp/displayDOE.html" class="code" title="function displayDOE(sampling,doe,missData)">displayDOE</a>(sortedSampling,doe)
0414 <span class="keyword">else</span>
0415     sortedSampling=[];
0416 <span class="keyword">end</span>
0417 
0418 <span class="comment">%output</span>
0419 out.sorted=sortedSampling;
0420 out.unsorted=sampling;
0421 
0422 <a href="mesuTime.html" class="code" title="function [tictoc_compt,tInit]=mesuTime(compteur,tps_init)">mesuTime</a>(tMesu,tInit);
0423 fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0424 <span class="keyword">end</span>
0425 
0426 
0427 <span class="comment">%%function for checking if a sampling already exists</span>
0428 <a name="_sub1" href="#_subfunctions" class="code">function [sampling,fich]=checkDOE(nameFile,np,ns)</a>
0429 
0430 <span class="comment">%check if the storage folder exists</span>
0431 <span class="keyword">if</span> exist(<span class="string">'tmpDOE/TIR_MANU'</span>,<span class="string">'dir'</span>)~=7
0432     mkdir(<span class="string">'tmpDOE/TIR_MANU'</span>);
0433 <span class="keyword">end</span>
0434 
0435 <span class="comment">%if the sampling exists, it will be loaded</span>
0436 fi=[<span class="string">'tmpDOE/TIR_MANU/'</span> nameFile <span class="string">'_man_'</span> num2str(np) <span class="string">'_'</span>  num2str(ns)];
0437 fich=[fi <span class="string">'.mat'</span>];
0438 <span class="keyword">if</span> exist(fich,<span class="string">'file'</span>)==2
0439     st=load(fich);
0440     sampling=st.sampling;
0441 <span class="keyword">else</span>
0442     fprintf(<span class="string">'Sampling does not exist \n'</span>);
0443     sampling=[];
0444 <span class="keyword">end</span>
0445 <span class="keyword">end</span>
0446</pre></div>
<hr><address>Generated on Mon 30-May-2016 21:25:53 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>