<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mmlhs_R</title>
  <meta name="keywords" content="mmlhs_R">
  <meta name="description" content="% Generation de plan d'experience LHS a partir de R (avec pretirage de LHS enrichi)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html LMTir --><!-- menu.html tirages -->
<h1>mmlhs_R
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>% Generation de plan d'experience LHS a partir de R (avec pretirage de LHS enrichi)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [tir,new_tir]=mmlhs_R(Xmin,Xmax,nb_samples,old_tir,nb_enrich) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Generation de plan d'experience LHS a partir de R (avec pretirage de LHS enrichi)
% LHS maximin
Refs: Beachkofski, B., Grandhi, R. (2002) Improved Distributed Hypercube Sampling American Institute of Aeronautics and Astronautics Paper 1274.
 L. LAURENT -- 02/01/2013 -- laurent@lmt.ens-cachan.fr</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../LMTir/routines/gene_doe.html" class="code" title="function [out,info_tirages]=gene_doe(doe)">gene_doe</a>	% Realisation des tirages</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Generation de plan d'experience LHS a partir de R (avec pretirage de LHS enrichi)</span>
0002 <span class="comment">%% LHS maximin</span>
0003 <span class="comment">%Refs: Beachkofski, B., Grandhi, R. (2002) Improved Distributed Hypercube Sampling American Institute of Aeronautics and Astronautics Paper 1274.</span>
0004 <span class="comment">% L. LAURENT -- 02/01/2013 -- laurent@lmt.ens-cachan.fr</span>
0005 
0006 
0007 
0008 <a name="_sub0" href="#_subfunctions" class="code">function [tir,new_tir]=mmlhs_R(Xmin,Xmax,nb_samples,old_tir,nb_enrich)</a>
0009 
0010 <span class="comment">%% INPUT:</span>
0011 <span class="comment">%    - Xmin,Xmax: bornes min et max de l'espace de concpetion</span>
0012 <span class="comment">%    - nb_samples: nombre d'echantillons requis</span>
0013 <span class="comment">%    - nb_enrich: nombre d'echantillons requis pour enrichir</span>
0014 <span class="comment">%% OUTPUT</span>
0015 <span class="comment">%   - tir: echantillons</span>
0016 <span class="comment">%   - new_tir: nouveaux echantillons en phase d'enrichissement</span>
0017 <span class="comment">%%</span>
0018 
0019 <span class="comment">%chemin librairies pour bonne execution R</span>
0020 setenv(<span class="string">'DYLD_LIBRARY_PATH'</span>,<span class="string">'/usr/local/bin/'</span>);
0021 
0022 <span class="comment">%%declaration des options</span>
0023 <span class="comment">% repertoire de stockage</span>
0024 rep=<span class="string">'LHS_R'</span>;
0025 <span class="comment">%nombre de plans pretires</span>
0026 nb_pretir=0;
0027 <span class="comment">%nom du fichier script r</span>
0028 nom_script=<span class="string">'mmlhs_R_'</span>;
0029 ext_script=<span class="string">'.r'</span>;
0030 <span class="comment">%nom du fichier de donnees R</span>
0031 nom_dataR=<span class="string">'dataR_'</span>;
0032 ext_dataR=<span class="string">'.dat'</span>;
0033 <span class="comment">%temps de pause apres execution R</span>
0034 tps_pause=0;
0035 <span class="comment">%options</span>
0036 <span class="comment">%nombre de permutation &quot;Columnwise Pairwise&quot;</span>
0037 nbperm=numel(Xmin);
0038 <span class="comment">%critere arret</span>
0039 crit_stop=1e-2;
0040 
0041 <span class="comment">%phase de creation des plans</span>
0042 <span class="keyword">if</span> nargin==3
0043     
0044     <span class="comment">% recuperation dimensions (nombre de variables et nombre d'echantillon)</span>
0045     nbs=nb_samples;
0046     nbv=numel(Xmin);
0047     <span class="comment">%nom fichier complet</span>
0048     nom_script=[nom_script num2str(nbv) <span class="string">'_'</span> num2str(nbs) ext_script];
0049     <span class="comment">%nom fichier donnees complet</span>
0050     nom_dataR=[nom_dataR num2str(nbv) <span class="string">'_'</span> num2str(nbs) ext_dataR];
0051     
0052     <span class="comment">%%ecriture d'un script R</span>
0053     <span class="comment">%Creation du repertoire de stockage (s'il n'existe pas)</span>
0054     <span class="keyword">if</span> exist(rep,<span class="string">'dir'</span>)~=7
0055         cmd=[<span class="string">'mkdir '</span> rep];
0056         unix(cmd);
0057     <span class="keyword">end</span>
0058     
0059     <span class="comment">%ecriture du script r</span>
0060     <span class="comment">%procedure de creation du tirage initial</span>
0061     text_init=[<span class="string">'a&lt;-maximinLHS('</span> num2str(nbs) <span class="string">','</span> num2str(nbv) <span class="string">','</span><span class="keyword">...</span>
0062         num2str(nbperm) <span class="string">','</span> num2str(crit_stop) <span class="string">')\n'</span>];
0063     <span class="comment">%procedure d'enrichissement</span>
0064     text_enrich=[<span class="string">'a&lt;-optAugmentLHS(a,1,4)\n'</span>];
0065     <span class="comment">%chargement librairie LHS</span>
0066     load_LHS=<span class="string">'library(lhs)\n'</span>;
0067     <span class="comment">%procedure stockage tirage</span>
0068     stock_tir=[<span class="string">'write.table(a,file=&quot;'</span> nom_dataR <span class="string">'&quot;,row.names=FALSE,col.names=FALSE)'</span>];
0069     
0070     <span class="comment">%creation et ouverture du fichier de script</span>
0071     fid=fopen([rep <span class="string">'/'</span> nom_script],<span class="string">'w'</span>,<span class="string">'n'</span>,<span class="string">'UTF-8'</span>);
0072     <span class="comment">%ecriture chargement librairie</span>
0073     fprintf(fid,load_LHS);
0074     <span class="comment">%ecriture tirage initial</span>
0075     fprintf(fid,text_init);
0076     <span class="comment">%ecriture de l'enrichissement</span>
0077     <span class="keyword">for</span> ii=1:nb_pretir
0078         fprintf(fid,text_enrich);
0079     <span class="keyword">end</span>
0080     <span class="comment">%ecriture de la procedure de sauvegarde</span>
0081     fprintf(fid,stock_tir);
0082     <span class="comment">%fermeture du fichier</span>
0083     fclose(fid);
0084     <span class="comment">%%execution du script R (necessite d'avoir r installe)</span>
0085     <span class="comment">%test de l'existence de</span>
0086     [e,t]=unix(<span class="string">'which R'</span>);
0087     <span class="keyword">if</span> e~=0
0088         error(<span class="string">'R non installe (absent du PATH)'</span>);
0089     <span class="keyword">else</span>
0090         [~,t]=unix([<span class="string">'cd '</span> rep <span class="string">' &amp;&amp; R -f '</span> nom_script]);
0091         pause(tps_pause)
0092     <span class="keyword">end</span>
0093     <span class="comment">%lecture du fichier de donnees R</span>
0094     A=load([rep <span class="string">'/'</span> nom_dataR]);
0095     <span class="comment">%tirage obtenu</span>
0096     tir=A(1:nbs,:).*repmat(Xmax(:)'-Xmin(:)',nbs,1)+repmat(Xmin(:)',nbs,1);
0097     new_tir=[];
0098     
0099     <span class="comment">%phase d'enrichissement</span>
0100 <span class="keyword">elseif</span> nargin==5
0101     
0102     <span class="comment">%nombre d'echantillons dans le tirage precedent</span>
0103     old_nbs=size(old_tir,1);
0104     
0105     <span class="comment">%chargement du fichier de donnees R</span>
0106     A=load([rep <span class="string">'/'</span> nom_dataR]);
0107     
0108     <span class="comment">%nouveaux tirages</span>
0109     ind=old_nbs+1:old_nbs+nb_enrich;
0110     new_tir=A(ind,:).*repmat(Xmax(:)'-Xmin(:)',nb_enrich,1)+repmat(Xmin(:)',nb_enrich,1);
0111     <span class="comment">%liste de tous les tirages</span>
0112     tir=[old_tir;new_tir];
0113     
0114     
0115 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 07-Feb-2014 19:36:29 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>