<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of exec_tri</title>
  <meta name="keywords" content="exec_tri">
  <meta name="description" content="% Tri de tirages">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html LMTir --><!-- menu.html routines -->
<h1>exec_tri
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>% Tri de tirages</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function tiragesTRI = exec_tri(tirages,doe) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Tri de tirages
% L. LAURENT -- 03/09/2013 -- laurent@lmt.ens-cachan.fr</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="gene_doe.html" class="code" title="function [out,info_tirages]=gene_doe(doe)">gene_doe</a>	% Realisation des tirages</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function N=normp(X,type)</a></li><li><a href="#_sub2" class="code">function tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)</a></li><li><a href="#_sub3" class="code">function tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Tri de tirages</span>
0002 <span class="comment">%% L. LAURENT -- 03/09/2013 -- laurent@lmt.ens-cachan.fr</span>
0003 
0004 <a name="_sub0" href="#_subfunctions" class="code">function tiragesTRI = exec_tri(tirages,doe)</a>
0005 <span class="comment">%pour normer</span>
0006 Xmin=doe.Xmin;
0007 Xmax=doe.Xmax;
0008 
0009 info_tri=doe.tri;
0010 <span class="comment">%norme employee</span>
0011 lnorm=info_tri.lnorm;
0012 <span class="comment">%nombre de points et variables</span>
0013 [nb_val,nb_var]=size(tirages);
0014 <span class="comment">%on norme</span>
0015 tirages=(tirages-repmat(Xmin(:)',nb_val,1))./repmat(Xmax(:)'-Xmin(:)',nb_val,1);
0016 
0017 <span class="keyword">if</span> info_tri.on
0018     tiragesTRI=zeros(nb_val,nb_var);
0019     tri_ok=true;
0020     <span class="comment">%tri en fonction du parametre considere</span>
0021     <span class="keyword">switch</span> info_tri.type
0022         <span class="keyword">case</span> {<span class="string">'v'</span>,<span class="string">'variable'</span>}
0023             <span class="comment">%on trie par rapport a une variable</span>
0024             <span class="keyword">if</span> isfield(info_tri,<span class="string">'para'</span>)&amp;&amp;info_tri.para&gt;0
0025                 <span class="keyword">if</span> info_tri.para&lt;=size(tirages,1)
0026                     [~,ind]=sort(tirages(:,info_tri.para));
0027                     tiragesTRI=tirages(ind,:);
0028                 <span class="keyword">end</span>
0029             <span class="keyword">end</span>
0030         <span class="keyword">case</span> {<span class="string">'nptp'</span>,<span class="string">'normal_pt_to_pt'</span>}
0031             <span class="comment">%on trie en debutant au nieme point (parametre) et en cherchant de point</span>
0032             <span class="comment">%en point (en utilisant la norme consideree</span>
0033             
0034             <span class="comment">%pt initial</span>
0035             ptref=[];
0036             <span class="keyword">if</span> isfield(info_tri,<span class="string">'ptref'</span>);<span class="keyword">if</span> ~isempty(info_tri.ptref);ptref=info_tri.ptref;<span class="keyword">end</span>, <span class="keyword">end</span>
0037             <span class="keyword">if</span> isfield(info_tri,<span class="string">'para'</span>);num_pt_ref=info_tri.para;<span class="keyword">else</span> num_pt_ref=1;<span class="keyword">end</span>
0038             <span class="keyword">if</span> num_pt_ref&lt;1||num_pt_ref&gt;nb_var;num_pt_ref=1;<span class="keyword">end</span>
0039             
0040             <span class="comment">%triage</span>
0041             <span class="keyword">if</span> isempty(ptref)
0042                 tiragesTRI=<a href="#_sub2" class="code" title="subfunction tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)">nptp</a>(tirages,lnorm,num_pt_ref,<span class="string">'exist'</span>,doe);
0043             <span class="keyword">else</span>
0044                 ptref=(ptref-Xmin(:)')./Xmax(:)';
0045                 tiragesTRI=<a href="#_sub2" class="code" title="subfunction tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)">nptp</a>(tirages,lnorm,ptref,<span class="string">'don'</span>,doe);
0046             <span class="keyword">end</span>
0047             
0048         <span class="keyword">case</span> {<span class="string">'p'</span>,<span class="string">'point'</span>}
0049             <span class="comment">%on trie en s'assurant que l'on cherche de point en point en</span>
0050             <span class="comment">%'tournant' autour du point initial en utilisant la norme retenue</span>
0051             
0052             <span class="comment">%pt initial</span>
0053             ptref=[];
0054             <span class="keyword">if</span> isfield(info_tri,<span class="string">'ptref'</span>);<span class="keyword">if</span> ~isempty(info_tri.ptref);ptref=info_tri.ptref;<span class="keyword">end</span>, <span class="keyword">end</span>
0055             <span class="keyword">if</span> isfield(info_tri,<span class="string">'para'</span>);num_pt_ref=info_tri.para;<span class="keyword">else</span> num_pt_ref=1;<span class="keyword">end</span>
0056             <span class="keyword">if</span> num_pt_ref&lt;1||num_pt_ref&gt;nb_var;num_pt_ref=1;<span class="keyword">end</span>
0057             
0058             <span class="comment">%triage</span>
0059             <span class="keyword">if</span> isempty(ptref)
0060                 tiragesTRI=<a href="#_sub3" class="code" title="subfunction tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)">barypt</a>(tirages,lnorm,num_pt_ref,<span class="string">'exist'</span>,doe);
0061             <span class="keyword">else</span>
0062                 ptref=(ptref-Xmin(:)')./Xmax(:)';
0063                 tiragesTRI=<a href="#_sub3" class="code" title="subfunction tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)">barypt</a>(tirages,lnorm,ptref,<span class="string">'don'</span>,doe);
0064             <span class="keyword">end</span>
0065             
0066         <span class="keyword">case</span> {<span class="string">'c'</span>,<span class="string">'center'</span>}
0067             <span class="comment">%on trie en s'assurant que l'on cherche de point en point en</span>
0068             <span class="comment">%'tournant' autour du centre (de l'espace) en utilisant la norme retenue</span>
0069             <span class="comment">%determination des coordonnees du centre de l'espace</span>
0070             pt_centre=(Xmax(:)'+Xmin(:)')./2;
0071             <span class="comment">%triage</span>
0072             tiragesTRI=<a href="#_sub3" class="code" title="subfunction tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)">barypt</a>(tirages,lnorm,pt_centre,<span class="string">'don'</span>,doe);
0073         <span class="keyword">case</span> {<span class="string">'sac'</span>,<span class="string">'sampling_center'</span>}
0074             <span class="comment">%on trie en s'assurant que l'on cherche de point en point en</span>
0075             <span class="comment">%'tournant' autour du centre (du tirage donne) en utilisant la norme retenue</span>
0076             <span class="comment">%determination des coordonnees du centre du tirage</span>
0077             min_tirages=min(tirages);
0078             max_tirages=max(tirages);
0079             pt_centre=(max_tirages+min_tirages)./2;
0080             <span class="comment">%triage</span>
0081             tiragesTRI=<a href="#_sub3" class="code" title="subfunction tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)">barypt</a>(tirages,lnorm,pt_centre,<span class="string">'don'</span>,doe);
0082         <span class="keyword">case</span> {<span class="string">'sc'</span>,<span class="string">'start_center'</span>}
0083             <span class="comment">%on trie en debutant par le point le plus proche du centre (de l'espace) et</span>
0084             <span class="comment">%en cherchant de point en point en utilisant la norme retenue</span>
0085             <span class="comment">%determination des coordonnees du centre de l'espace</span>
0086             pt_centre=(Xmax(:)'+Xmin(:)')./2;
0087             <span class="comment">%triage</span>
0088             tiragesTRI=<a href="#_sub2" class="code" title="subfunction tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)">nptp</a>(tirages,lnorm,pt_centre,<span class="string">'don'</span>,doe);
0089             
0090         <span class="keyword">case</span> {<span class="string">'sasc'</span>,<span class="string">'sampling_start_center'</span>}
0091             <span class="comment">%on trie en debutant par le point le plus proche du centre (du tirage donne) et</span>
0092             <span class="comment">%en cherchant de point en point en utilisant la norme retenue</span>
0093             
0094             <span class="comment">%determination des coordonnees du centre du tirage</span>
0095             min_tirages=min(tirages);
0096             max_tirages=max(tirages);
0097             pt_centre=(max_tirages+min_tirages)./2;
0098             <span class="comment">%triage</span>
0099             tiragesTRI=<a href="#_sub2" class="code" title="subfunction tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)">nptp</a>(tirages,lnorm,pt_centre,<span class="string">'don'</span>,doe);
0100         <span class="keyword">otherwise</span>
0101             tri_ok=false;
0102             
0103     <span class="keyword">end</span>
0104     
0105     <span class="keyword">if</span> ~tri_ok
0106         fprintf(<span class="string">'###############################################################\n'</span>);
0107         fprintf(<span class="string">'## ##mauvais parametre de tri des tirages (tri desactive) ## ##\n'</span>);
0108         fprintf(<span class="string">'###############################################################\n'</span>);
0109     <span class="keyword">end</span>
0110 <span class="keyword">else</span>
0111     tiragesTRI=tirages;
0112 <span class="keyword">end</span>
0113 <span class="comment">%on denorme</span>
0114 tiragesTRI=tiragesTRI.*repmat(Xmax(:)'-Xmin(:)',nb_val,1)+repmat(Xmin(:)',nb_val,1);
0115 <span class="keyword">end</span>
0116 
0117 <span class="comment">%norme vecteur (meilleure fonctionnement que norm de matlab)</span>
0118 <a name="_sub1" href="#_subfunctions" class="code">function N=normp(X,type)</a>
0119 <span class="comment">%on test si on demande une norme infinie</span>
0120 norminf=isinf(type);
0121 ninf=false;
0122 <span class="comment">%valeurs absolue des composantes</span>
0123 Xabs=abs(X);
0124 
0125 <span class="keyword">if</span> norminf
0126     <span class="keyword">if</span> -abs(type)==type;ninf=true;<span class="keyword">end</span>
0127     
0128     <span class="keyword">if</span> ninf
0129         <span class="comment">%norme -Inf</span>
0130         N=min(Xabs,[],2);
0131     <span class="keyword">else</span>
0132         <span class="comment">%norme Inf</span>
0133         N=max(Xabs,[],2);
0134     <span class="keyword">end</span>
0135 <span class="keyword">else</span>
0136     <span class="comment">%norme p</span>
0137     N=sum(Xabs.^type,2).^(1/type);
0138 <span class="keyword">end</span>
0139 <span class="keyword">end</span>
0140 
0141 <span class="comment">%fonction assurant le tri de pts en pts avec pt initial choisi parmi les</span>
0142 <span class="comment">%points existant (exist) ou a partir dun point donne (don)</span>
0143 <a name="_sub2" href="#_subfunctions" class="code">function tirages_trie=nptp(tirages,lnorm,info_pt,type,doe)</a>
0144 <span class="comment">%nombre de points et variables</span>
0145 [nb_val,nb_var]=size(tirages);
0146 tirages_trie=zeros(nb_val,nb_var);
0147 <span class="comment">%liste des numeros de points</span>
0148 liste_num=1:nb_val;
0149 <span class="comment">%en fonction du type de pt initial</span>
0150 <span class="keyword">switch</span> type
0151     <span class="keyword">case</span> <span class="string">'exist'</span>
0152         <span class="comment">%a partir dun point existant</span>
0153         num_pt_ref=info_pt;
0154         pt_ref=tirages(num_pt_ref,:);
0155         tirages_trie(1,:)=pt_ref;
0156         liste_num(num_pt_ref)=[];
0157         debutfor=1;
0158     <span class="keyword">case</span> <span class="string">'don'</span>
0159         <span class="comment">%a partir d'un point donne</span>
0160         pt_ref=info_pt;
0161         debutfor=0;
0162 <span class="keyword">end</span>
0163 <span class="comment">%pour normer les coordonnees</span>
0164 xnorm=doe.Xmax(:)'-doe.Xmin(:)';
0165 <span class="comment">%on trie</span>
0166 <span class="keyword">for</span> ii=debutfor:nb_val-1
0167     <span class="comment">%on calcule la distance du point considere aux points</span>
0168     <span class="comment">%restants</span>
0169     xdiff=pt_ref(ones(1,nb_val-ii),:)-tirages(liste_num,:);
0170     xdiff=xdiff./xnorm(ones(1,nb_val-ii),:);
0171     dist=<a href="#_sub1" class="code" title="subfunction N=normp(X,type)">normp</a>(xdiff,lnorm);
0172     <span class="comment">%on cherche le minimum</span>
0173     [~,IXD_min]=min(dist);
0174     num_pt_ref=liste_num(IXD_min(1));
0175     liste_num(IXD_min(1))=[];
0176     
0177     <span class="comment">%nouveau point de reference</span>
0178     pt_ref=tirages(num_pt_ref,:);
0179     tirages_trie(ii+1,:)=pt_ref;
0180 <span class="keyword">end</span>
0181 <span class="keyword">end</span>
0182 
0183 <span class="comment">%fonction assurant le tri de pts en pts avec pt initial choisi parmi les</span>
0184 <span class="comment">%points existant (exist) ou a partir dun point donne (don) en 'tournant'</span>
0185 <span class="comment">%autour du point initial (par pris en compte du barycentre des sites)</span>
0186 <a name="_sub3" href="#_subfunctions" class="code">function tirages_trie=barypt(tirages,lnorm,info_pt,type,doe)</a>
0187 <span class="comment">%parametre distance barycentre</span>
0188 dbary=0.5;
0189 <span class="comment">%nombre de points et variables</span>
0190 [nb_val,nb_var]=size(tirages);
0191 tirages_trie=zeros(nb_val,nb_var);
0192 <span class="comment">%liste des numeros de points</span>
0193 liste_num=1:nb_val;
0194 <span class="comment">%en fonction du type de pt initial</span>
0195 <span class="keyword">switch</span> type
0196     <span class="keyword">case</span> <span class="string">'exist'</span>
0197         <span class="comment">%a partir dun point existant</span>
0198         num_pt_ref=info_pt;
0199         pt_ref=tirages(num_pt_ref,:);
0200         pt_init=pt_ref;
0201         tirages_trie(1,:)=pt_ref;
0202         liste_num(num_pt_ref)=[];
0203         debutfor=1;
0204     <span class="keyword">case</span> <span class="string">'don'</span>
0205         <span class="comment">%a partir d'un point donne</span>
0206         pt_ref=info_pt;
0207         pt_init=pt_ref;
0208         debutfor=0;
0209 <span class="keyword">end</span>
0210 <span class="comment">%pour normer les coordonnees</span>
0211 xnorm=doe.Xmax(:)'-doe.Xmin(:)';
0212 <span class="comment">%on trie</span>
0213 <span class="keyword">for</span> ii=debutfor:nb_val-1
0214     <span class="comment">%on calcule la distance du point considere aux points</span>
0215     <span class="comment">%restants</span>
0216     xdiff=pt_ref(ones(1,nb_val-ii),:)-tirages(liste_num,:);
0217     xdiff=xdiff./xnorm(ones(1,nb_val-ii),:);
0218     dist=<a href="#_sub1" class="code" title="subfunction N=normp(X,type)">normp</a>(xdiff,lnorm);
0219     <span class="comment">%on cherche le minimum</span>
0220     [~,IXD_min]=min(dist);
0221     num_pt_add=liste_num(IXD_min(1));
0222     liste_num(IXD_min(1))=[];
0223     
0224     <span class="comment">%ajout du pt au tirage</span>
0225     tirages_trie(ii+1,:)=tirages(num_pt_add,:);
0226     
0227     <span class="comment">%calcul du nouveau point de reference par calcul du barycentre des</span>
0228     <span class="comment">%points deja balaye</span>
0229     nb_pts=ii+1;
0230     bary=1/nb_pts*sum(tirages_trie(1:nb_pts,:),1);
0231     pt_ref=pt_init+dbary*(bary-pt_init);
0232 <span class="keyword">end</span>
0233 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 07-Feb-2014 19:36:29 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>